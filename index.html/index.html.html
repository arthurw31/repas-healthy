<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inspiration Repas Healthy</title>
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="Générateur d'idées pour repas healthy">
    
    <!-- PWA Manifest -->
    <link rel="manifest" data-href="data:application/json;base64,ewogICJuYW1lIjogIkluc3BpcmF0aW9uIFJlcGFzIEhlYWx0aHkiLAogICJzaG9ydF9uYW1lIjogIlJlcGFzIEhlYWx0aHkiLAogICJkZXNjcmlwdGlvbiI6ICJHZW5lcmF0ZXVyIGQnaWRlZXMgcG91ciByZXBhcyBoZWFsdGh5IiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrUEhKbFkzUWdkMmxrZEdnOUlqRXlPQ0lpSUdobGFXZG9kRDBpTVRJNElpQm1hV3hzUFNJak5qWTNaV1ZoSWk4K1BIUmxlSFFnZUQwaU5qUWlJSGs5SWpZMElpQm1iMjUwTFdaaGJXbHNlVDBpUVhKcFlXd2lJR1p2Ym5RdGMybDZaVDBpTXpaaUlpQm1hV3hzUFNJamRtWm1abVptSWo0NFl6OHZKM1JsZUhRK1BDOXpkbWMrIiwKICAgICAgInNpemVzIjogIjEyOHgxMjgiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgZmlsbD0iIzY2N2VlYSIvPjx0ZXh0IHg9IjY0IiB5PSI2NCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjM2IiBmaWxsPSIjZmZmZmZmIj7wn42dPC90ZXh0Pjwvc3ZnPg==">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        h1 {
            color: #333;
            font-size: 2em;
            font-weight: 300;
        }
        
        .edit-toggle {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .edit-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .edit-toggle.active {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }
        
        .install-banner {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }
        
        .install-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid white;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            margin-left: 10px;
            cursor: pointer;
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 10px;
            font-size: 14px;
            font-weight: 600;
            text-align: left;
            vertical-align: top;
            position: sticky;
            top: 0;
            z-index: 10;
            position: relative;
        }
        
        .add-category-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            margin-left: 8px;
            cursor: pointer;
            font-size: 12px;
            display: none;
        }
        
        .edit-mode .add-category-btn {
            display: inline-block;
        }
        
        td {
            padding: 15px 10px;
            vertical-align: top;
            border-right: 1px solid #e9ecef;
            background: #fafbfc;
            position: relative;
        }
        
        td:last-child {
            border-right: none;
        }
        
        .item {
            display: block;
            padding: 6px 10px;
            margin: 3px 0;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            color: #555;
            border-left: 3px solid;
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        
        .item:hover, .item:active {
            transform: translateX(3px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .item.selected {
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 500;
        }
        
        .delete-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            cursor: pointer;
            display: none;
        }
        
        .edit-mode .item:hover .delete-btn {
            display: block;
        }
        
        .add-item-btn {
            background: #f0f0f0;
            border: 2px dashed #ccc;
            color: #666;
            text-align: center;
            padding: 8px;
            margin: 3px 0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: none;
        }
        
        .edit-mode .add-item-btn {
            display: block;
        }
        
        .add-item-btn:hover {
            background: #e0e0e0;
            border-color: #999;
        }
        
        .item-input {
            width: 100%;
            padding: 6px 10px;
            margin: 3px 0;
            border: 2px solid #4ecdc4;
            border-radius: 6px;
            font-size: 12px;
            background: white;
        }
        
        /* Couleurs par colonne */
        .col-entrees .item { border-left-color: #ff6b6b; }
        .col-entrees .item:hover { background: #fff5f5; }
        
        .col-sauces .item { border-left-color: #4ecdc4; }
        .col-sauces .item:hover { background: #f0fdfc; }
        
        .col-proteines .item { border-left-color: #45b7d1; }
        .col-proteines .item:hover { background: #f0f9ff; }
        
        .col-glucides .item { border-left-color: #96ceb4; }
        .col-glucides .item:hover { background: #f0fdf4; }
        
        .col-legumes .item { border-left-color: #feca57; }
        .col-legumes .item:hover { background: #fffbeb; }
        
        .col-cuissons .item { border-left-color: #ff9ff3; }
        .col-cuissons .item:hover { background: #fdf4ff; }
        
        .col-desserts .item { border-left-color: #a8e6cf; }
        .col-desserts .item:hover { background: #f0fdf4; }
        
        .emoji {
            font-size: 1.1em;
            margin-right: 5px;
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 15px;
                border-radius: 15px;
            }
            
            .header {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
            
            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }
            
            th {
                padding: 12px 8px;
                font-size: 12px;
            }
            
            td {
                padding: 12px 8px;
            }
            
            .item {
                font-size: 11px;
                padding: 5px 8px;
                margin: 2px 0;
            }
            
            .table-container {
                border-radius: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            th {
                padding: 10px 6px;
                font-size: 11px;
            }
            
            td {
                padding: 10px 6px;
            }
            
            .item {
                font-size: 10px;
                padding: 4px 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🍽️ Inspiration Repas Healthy</h1>
            <button class="edit-toggle" id="editToggle">✏️ Mode Édition</button>
        </div>
        
        <div class="install-banner" id="installBanner">
            📱 Installe cette app sur ton téléphone pour un accès rapide !
            <button class="install-btn" id="installBtn">Installer</button>
        </div>
        
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th><span class="emoji">🥗</span>ENTRÉES <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">🥄</span>BASES SAUCES <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">🍖</span>PROTÉINES & CUISSONS <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">🌾</span>GLUCIDES <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">🥬</span>LÉGUMES <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">⚡</span>TECHNIQUES CUISSON <button class="add-category-btn">+</button></th>
                        <th><span class="emoji">🍨</span>DESSERTS <button class="add-category-btn">+</button></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="col-entrees" data-category="entrees">
                            <div class="add-item-btn">+ Ajouter une entrée</div>
                        </td>
                        
                        <td class="col-sauces" data-category="sauces">
                            <div class="add-item-btn">+ Ajouter une sauce</div>
                        </td>
                        
                        <td class="col-proteines" data-category="proteines">
                            <div class="add-item-btn">+ Ajouter une cuisson</div>
                        </td>
                        
                        <td class="col-glucides" data-category="glucides">
                            <div class="add-item-btn">+ Ajouter un glucide</div>
                        </td>
                        
                        <td class="col-legumes" data-category="legumes">
                            <div class="add-item-btn">+ Ajouter une cuisson</div>
                        </td>
                        
                        <td class="col-cuissons" data-category="cuissons">
                            <div class="add-item-btn">+ Ajouter une technique</div>
                        </td>
                        
                        <td class="col-desserts" data-category="desserts">
                            <div class="add-item-btn">+ Ajouter un dessert</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Données initiales
        const initialData = {
            entrees: ["Soupe froide", "Gaspacho", "Velouté", "Soupe miso", "Bouillon", "Consommé", "Salade verte", "Salade composée", "Salade de céréales", "Bowl cru", "Crudités", "Carpaccio", "Tartare", "Ceviche", "Hummus", "Guacamole", "Baba ganoush", "Tapenade", "Dips", "Mousse", "Terrine"],
            sauces: ["Base fromage blanc", "Base yaourt grec", "Base sauce soja", "Base miso", "Base tahini", "Mayo avocat", "Mayo yaourt", "Vinaigrette classique", "Vinaigrette asiatique", "Pesto", "Chimichurri", "Sauce verte", "Sauce épicée", "Sauce crémeuse", "Marinade", "Émulsion"],
            proteines: ["Grillé", "Air fryer", "Mariné", "Mi-cuit", "Fumé", "Vapeur", "Papillote", "Sauté", "Poêlé", "Effiloché", "Mollet", "Brouillé", "En omelette", "Confit", "Cru", "Slow cook", "Sous-vide", "Rôti", "Braisé", "En sauce", "Pané", "Laqué"],
            glucides: ["Riz complet", "Riz noir", "Riz rouge", "Quinoa", "Boulgour", "Épeautre", "Sarrasin", "Farro", "Orge", "Millet", "Avoine salée", "Pâtes complètes", "Pâtes légumineuses", "Shiratakis", "Patate douce", "Pommes de terre", "Courge", "Riz de chou-fleur", "Courgetti", "Pain complet", "Galettes", "Polenta"],
            legumes: ["Vapeur", "Air fryer", "Grillés", "Rôtis four", "Poêlés", "Sautés wok", "Braisés", "Confits", "Papillote", "Crus", "Massés", "Marinés", "Lacto-fermentés", "Pickles", "Glacés", "À l'étouffée", "Tempura", "Fumés", "En soupe", "En purée", "En chips", "Spiralés"],
            cuissons: ["Air Fryer 180°C", "Plancha haute température", "Grill/Barbecue", "Poêle antiadhésive", "Wok sauté rapide", "Four 200°C chaleur tournante", "Four vapeur 85°C", "Cuisson vapeur douce", "Papillote hermétique", "Pochage eau frémissante", "Marinade à froid", "Sous-vide basse température", "Smoking fumage léger", "Searing haute température", "Braisage cocotte", "Slow cooking mijoteuse", "Fermentation lactique", "Déshydratation", "Cru mariné acidulé", "Confit huile d'olive"],
            desserts: ["Nice cream", "Chia pudding", "Mousse", "Yaourt grec", "Skyr", "Fromage blanc", "Compote", "Fruits pochés", "Salade de fruits", "Energy balls", "Bark chocolat", "Smoothie bowl", "Panna cotta", "Tiramisù", "Cheesecake cru", "Tarte crue", "Muffins", "Cookies", "Granola", "Parfait", "Sorbet", "Pudding"]
        };

        // Chargement des données depuis le stockage local ou utilisation des données initiales
        let userData = JSON.parse(localStorage.getItem('mealPlannerData')) || JSON.parse(JSON.stringify(initialData));

        let editMode = false;

        // PWA Installation
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBanner.style.display = 'block';
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installBanner.style.display = 'none';
            }
        });

        window.addEventListener('appinstalled', () => {
            installBanner.style.display = 'none';
        });

        // Mode édition
        document.getElementById('editToggle').addEventListener('click', function() {
            editMode = !editMode;
            document.body.classList.toggle('edit-mode', editMode);
            this.textContent = editMode ? '✅ Sauvegarder' : '✏️ Mode Édition';
            this.classList.toggle('active', editMode);
            
            if (!editMode) {
                saveData();
            }
        });

        // Sauvegarde des données
        function saveData() {
            localStorage.setItem('mealPlannerData', JSON.stringify(userData));
        }

        // Rendu des données
        function renderData() {
            Object.keys(userData).forEach(category => {
                const column = document.querySelector(`[data-category="${category}"]`);
                const addBtn = column.querySelector('.add-item-btn');
                
                // Supprime les anciens items (sauf le bouton d'ajout)
                column.querySelectorAll('.item').forEach(item => item.remove());
                
                // Ajoute les nouveaux items
                userData[category].forEach(item => {
                    const itemEl = createItemElement(item, category);
                    column.insertBefore(itemEl, addBtn);
                });
            });
        }

        // Création d'un élément item
        function createItemElement(text, category) {
            const item = document.createElement('span');
            item.className = 'item';
            item.textContent = text;
            
            // Bouton de suppression
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = '×';
            deleteBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                deleteItem(text, category);
            });
            
            item.appendChild(deleteBtn);
            
            // Sélection
            item.addEventListener('click', function() {
                if (!editMode) {
                    this.classList.toggle('selected');
                }
            });
            
            return item;
        }

        // Suppression d'un item
        function deleteItem(text, category) {
            const index = userData[category].indexOf(text);
            if (index > -1) {
                userData[category].splice(index, 1);
                renderData();
            }
        }

        // Ajout d'un item
        function addItem(category) {
            const input = document.createElement('input');
            input.className = 'item-input';
            input.placeholder = 'Tape ton nouvel élément...';
            
            const column = document.querySelector(`[data-category="${category}"]`);
            const addBtn = column.querySelector('.add-item-btn');
            column.insertBefore(input, addBtn);
            
            input.focus();
            
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const text = input.value.trim();
                    if (text && !userData[category].includes(text)) {
                        userData[category].push(text);
                        renderData();
                    } else {
                        input.remove();
                    }
                }
            });
            
            input.addEventListener('blur', () => {
                const text = input.value.trim();
                if (text && !userData[category].includes(text)) {
                    userData[category].push(text);
                    renderData();
                } else {
                    input.remove();
                }
            });
        }

        // Event listeners pour les boutons d'ajout
        document.querySelectorAll('.add-item-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const category = btn.closest('td').dataset.category;
                addItem(category);
            });
        });

        // Initialisation
        renderData();

        // Service Worker pour fonctionnement offline
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swCode = `
                    const CACHE_NAME = 'repas-healthy-v2';
                    const urlsToCache = ['/'];
                    
                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });
                    
                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => response || fetch(event.request))
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(() => console.log('SW registered'))
                    .catch(() => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
